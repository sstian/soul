---
title: 码农翻身
categories: Technology
tags:
  - coderising
  - 刘欣
abbrlink: ce95
date: 2021-11-10 21:42:59
---

## 半小时漫画计算机

### 操作系统

多线程抢占式调度。
协程：可自主暂停 <= 运行控制权转移，完全由程序调度和掌控。

CPU => 取指令，译码，执行，写回。

浮点数运算：小数变整数，记录小数位。
`Java: BigDecimal. Python: Decimal. Ruby: BigDecimal`

#### 一切皆文件

```c
// File
int (*open)(...)
void (*close)(...)
int (*read)(...)
int (*write)(...)

// Socket=(IP, Port)
服务器监听 listen
客户端连接 connect
然后读写 read/write
最后关闭 close
```

#### 函数栈

栈帧：栈中的元素。
ESP=Extended Stack Pointer 扩展栈指针寄存器。存放函数栈顶指针
EBP=Extended Base Pointer 扩展基址指针寄存器。存放函数栈底指针

#### C文件编译

![C文件编译](https://cdn.jsdelivr.net/gh/sstian/images/blogimg/C文件编译.jpg)

#### 32位CPU寄存器

![32位CPU寄存器](https://cdn.jsdelivr.net/gh/sstian/images/blogimg/32位CPU寄存器.png)

![32位CPU寄存器-可编程](https://cdn.jsdelivr.net/gh/sstian/images/blogimg/32位CPU寄存器-可编程.png)

![32位CPU寄存器-通用](https://cdn.jsdelivr.net/gh/sstian/images/blogimg/32位CPU寄存器-通用.png)

![32位CPU寄存器-段](https://cdn.jsdelivr.net/gh/sstian/images/blogimg/32位CPU寄存器-段-2.png)

### 数据库

#### 事务

A = Atomicity 原子性：要么不做，要么全做。
C = Consistency 一致性：数据库保持完整性。
I = Isolation 隔离性：多事务并发执行。
D = Durability 持久性：数据的修改是永久的。

排它锁/X锁：Exclusive Lock。用于写数据。
共享锁/S锁：Share Lock。用于读数据。

| 加锁程度          | 隔离级别                  | 更新丢失 | 脏读 | 不可重复读 | 幻读     |
| ----------------- | ------------------------- | -------- | ---- | ---------- | -------- |
| X, 直到事务结束   | 读未提交 Read Uncommitted | Y        |      |            |          |
| X+S: 读完立即释放 | 读已提交 Read Committed   | Y        | Y    |            |          |
| X+S, 直到事务结束 | 可重复读 Repeatable Read  | Y        | Y    | Y - 锁行   |          |
| 串行执行          | 串行化 Serializable       | Y        | Y    | Y          | Y - 锁表 |

#### 日志

初始值：A=200, B=100

| 流程 | 事务T1      | Undo日志文件 |                                        | Redo日志文件 |                                        |
| ---- | ----------- | ------------ | -------------------------------------- | ------------ | -------------------------------------- |
| 1    |             | <T1, 开始>   | 事务开始                               | <T1, 开始>   | 事务开始                               |
| 2    |             | <T1, A, 200> | 记录A的**初始值**                      |              |                                        |
| 3    | A := A - 50 |              |                                        |              |                                        |
| 4    |             |              |                                        | <T1, A, 150> | 记录A的**最新值**                      |
| 5    |             | <T1, B, 100> | 记录B的**初始值**                      |              |                                        |
| 6    | B := B + 50 |              |                                        |              |                                        |
| 7    |             |              |                                        | <T1, B, 150> | 记录B的**最新值**                      |
| 8    |             |              |                                        | <T1, 提交>   | 事务提交，<br />在A, B**写入磁盘之前** |
| 9    | 把A写入磁盘 |              |                                        |              |                                        |
| 10   | 把B写入磁盘 |              |                                        |              |                                        |
| 11   |             | <T1, 提交>   | 事务提交，<br />在A, B**写入磁盘之后** | <T1, 结束>   |                                        |

**恢复策略：**

- Undo日志文件
  1. 系统重启时，检查Undo日志文件；
  2. 对于事务T1，若没有`<T1, 提交>`记录，表示该事务在执行过程中失败了，则恢复操作；
  3. 利用Undo日志中记录的A, B的初始值。由于幂等性，恢复多少遍结果都一样；
  4. 恢复完，在日志文件中加上`<T1, 回滚>`，表示下次不再恢复与T1相关的。
  
- Redo日志文件
  1. 在Redo日志文件中查找日志：有`<T1, 提交>`但没有`<T1, 结束>`；
  2. 把A, B的新值写入磁盘；
  3. 最后加上`<T1, 结束>`。

### 编程语言

#### 执行方式

> MSIL=Microsoft Intermediate Language 微软中间语言

| 执行方式             | 编程语言                                      | 特点               |
| -------------------- | --------------------------------------------- | ------------------ |
| 1. 编译执行          | Ada, C, C++, Rust, Go                         | 执行快；难以跨平台 |
| 2. 字节码：编译+解释 | Java                                          |                    |
|                      | Clojure, Scala, Jython, JRuby, Groovy, Kotlin | 编译成Java字节码   |
|                      | Ruby, PHP, Perl, Python                       | 创建自己的字节码   |
|                      | C#, VB.NET                                    | MSIL               |

#### 面向对象圣经

又名“神不在的星期天”

| 序列 | 内容                         | 说明                                                         | 相关人物                                               |
| ---- | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------ |
| 1    | 编译器                       |                                                              | John Warner Backus 计算机科学先驱之一、图灵奖获得者    |
| 2    | 函数、数据结构               | 程序=算法+数据结构                                           | Dennis Ritchie C语言之父、UNIX创造者之一               |
| 3    | Object                       | `typedef struct Stack {...} Stack;`                          | Alan Kay 面向对象编程思想的创始人之一                  |
| 4    | Class                        | 重复的方法代码公共化，隐藏this/self。`Stack* stack = new Stack();` |                                                        |
| 5    | 继承、多态、设计模式 => 复用 | 优先使用组合而不是继承，面向接口编程而不是面向实现编程       | Erich Gamma ... 《设计模式：可复用面向对象软件的基础》 |
| 6    | 抽象                         | 系统需求抽象成高层的概念，在概念层次进行编程                 |                                                        |
| 7    | 休息……                       |                                                              |                                                        |

#### 通用特性

冯·诺依曼计算机

| 通用特性                     | 说明                                                       | 范例                                           |
| ---------------------------- | ---------------------------------------------------------- | ---------------------------------------------- |
| 面向对象                     | 封装、继承、多态，Prototype / Mixin / Traits / Duck Typing |                                                |
| 函数式编程                   | 高阶函数、闭包、惰性求值、递归、不可变状态、无副作用……     | JVM: Lisp, Clojure                             |
| 元编程                       |                                                            | Java动态代理CgLib，Lisp宏                      |
| 并发模型                     | 同步与互斥、锁、死锁、软件事务内存……                       | Java线程，Python协程，Go routine, Erlang Actor |
| 虚拟机和垃圾回收             |                                                            | JVM垃圾回收                                    |
| 静态类型、动态类型、类型推导 | 静态类型：编译期确定。动态类型：运行期确定                 |                                                |
| 抽象语法树                   | AST=Abstract Syntax Trees                                  |                                                |
| 指针                         |                                                            | C语言的灵魂                                    |
| 其它                         | 错误处理（异常）、泛型、同步异步、序列化                   |                                                |

## 码农翻身

- 用通俗易懂的方式讲解技术。用故事讲解技术的本质。
- 软件开发不就是抽象嘛。
- 既然改变不了别人，那就改变一下自己吧。
- 创造一个新工具，造福大家的想法一直激励着自己，有时候甚至觉得很快乐，不觉得累，每天都恋恋不舍地去上床睡觉。
- 大部分人只会抱怨项目很无趣、没有挑战，遇到问题也只会安于现状。只有少数人会发现工作中的“痛点”，并且真正动手解决它，给公司带来价值。这是提高自己，让自己和别人区分开来的重要方法。
- 源码之前，了无秘密。
- 软件的复杂性，尤其是复杂在细节上。

### 4. 代码管理那些事儿

VCS = Version Control System 版本控制系统
- 集中式：代码仓库共享，只在服务器端，如：CVS, SVN
- 分布式：每个人都有一个本地私有代码仓库，服务器端代码仓库共享，如：Git, Mercury, IBM RTC

Pull Request 拉取请求：请求项目维护者拉取自己的修改。
GitHub：Web版本的代码托管平台

Maven之路径的约定：“约定重于配置”
| 文件                     | 路径               |
| ------------------------ | ------------------ |
| Java源文件               | src/main/java      |
| Resource文件             | src/main/resources |
| Web应用的源码            | src/main/webapp    |
| Java单元测试源文件       | src/test/java      |
| Java单元测试Resource文件 | src/test/resources |
| 编译后的Java class文件   | target/classes     |

面向对象的代码是针对接口编程的。
重构的过程基本就是一个重新设计的过程。很少公司能推倒重来，要么业务发生了变革，要么技术进行了转型；慢慢重构，所谓的革新，而不是革命。
TDD = Test Driven Development 测试驱动开发

《修改代码的艺术》，接缝：程序中一些特殊的点，在这些点上无需修改现有代码，只需要编写扩展代码就可以达到改动程序行为的目的。Mock代码通常可以在这里安插。
Mock工具：EasyMock, Jmockit
如何做单元测试，关键在于如何处理遗留代码。
优秀的单元测试：
1.单元测试是“白盒测试”，应该覆盖各个分支流程、异常条件。
2.单元测试面向的是一个单元（Unit），是由Java中的一个类或者几个类组成的单元。
3.单元测试的运行速度一定要快！
4.单元测试一定是可重复执行的！
5.单元测试之间不能有相互依赖，应该是独立的！
6.单元测试代码和业务代码同等重要，要一并维护！

### 5. 我的编程语言简史

前端“三剑客”：
HTML负责结构布局
CSS负责美化展示
JavaScript负责交互逻辑

JavaScript，操作HTML的DOM和浏览器。
XMLHttpRequest，允许JavaScript直接向服务器发起接口调用。
AJAX = Asynchronous JavaScript And XML，用作的异步处理方式，使得网页局部刷新。

Node.js，使用Chrome V8引擎执行JavaScript，用于服务端。只用一个线程处理所有请求，事件驱动编程。

C语言，代码的可移植性，并非程序的可移植性。做系统级编程，使用指针直接操作内存、和硬件交互，追求性能和效率。
代码指源代码，不同系统平台使用条件编译。程序指编译后的。
*.exe一旦运行，那就是一个独立的进程，拥有一个独立的地址空间，被CPU独立调度。
Java虚拟机（java.exe）才是一个进程，*.class被装载以后只能在这个进程里作为一个线程来运行。
链接：把一个符号（调用的函数的名称）和这个符号的地址（调用的函数的真正地址，有该函数的指令）绑定起来。
C在编译时链接，即静态链接。Java在运行时链接，即动态链接。

C++之父：现在C++教育似乎进入了一个怪圈，要教会一个人C++，唯一的办法就是把他教成C++高手。
学习编程语言的经验：多读书，多实践，多看优秀的源码。
书籍：《C++ Primer》《深入理解C++对象模型》《Effective C++》《VC++技术内幕》《深入浅出MFC》

Java，最适合后端编程。Applet，速度慢，还丑。
书籍：《Effective Java》《Java编程思想》《Java核心技术》《深入Java虚拟机》

DSL = Domain Specific Language 领域特定语言
SQL就是对数据库操作的DSL。

Ruby on Rails (RoR) 利用Ruby语言近乎“变态”的灵活性，以及“约定重于配置”的实践，把Web开发简化到了极致。
Ruby代码简洁、优雅、富有表现力。

在一台冯·诺依曼计算机中，最核心的就是CPU和指令，指令和数据就存放在内存当中，CPU每次取出一条指令，译码、执行，然后把结果写回内存，本质就这么简单。

函数式编程 Functional Programming：
一种"编程范式"（programming paradigm），即如何编写程序的方法论。
属于"结构化编程"的一种，主要思想是把运算过程尽量写成一系列嵌套的函数调用。
特性：声明式，闭包/仿函数（functor）对象和高阶函数，惰性计算，用递归而不用迭代。
特点：
1. 函数是"第一等公民"
函数与其他数据类型一样，处于平等地位，可以赋值给其他变量，也可以作为参数，传入另一个函数，或者作为别的函数的返回值。
2. 只用"表达式"，不用"语句"
每一步都是单纯的运算，而且都有返回值。
"表达式"（expression）是一个单纯的运算过程，总是有返回值；"语句"（statement）是执行某种操作，没有返回值。
3. 没有"副作用"
函数要保持独立，所有功能就是返回一个新的值，没有其他行为，尤其是不得修改外部变量的值。
"副作用"（side effect），指的是函数内部与外部互动（最典型的情况，就是修改全局变量的值），产生运算以外的其他结果。
4. 不修改状态
只是返回新的值，不修改系统变量。使用参数保存状态，最好的例子就是递归。
5. 引用透明性
同样的输入，函数总是返回同样的结果。

### 6. 老司机的精进

世上哪儿有等你完全准备好以后才开始的事情？你觉得完全准备好以后，黄花菜都凉了。
对于性格内向的程序员，很多时候你认为基本准备好了其实就够了，凡是必先骑上虎背，勇敢地迈出去，努力地争取一下，你就会发现自己登上了更高一层的台阶。

码农“潜规则”：
1. 局部性原理
在一段时间内，整个程序的执行仅限于程序的某一部分，相应地，程序访问的存储空间也局限于某个内存区域。局部性原理具体分为两类。
1.时间局部性：如果程序中的某条指令一旦执行，则不就之后该指令可能再次被执行；如果某数据被访问，则不久之后该数据可能再次被访问。
2.空间局部性：是指一旦程序访问了某个存储单元，则不久之后，其附近的存储单元也将被访问。
2. 缓存
3. 抽象
《深入理解计算机系统》：指令集是对CPU的抽象，文件是对输入/输出设备的抽象，虚拟存储是对程序存储的抽象，进程是对一个正在运行的程序的抽象，而虚拟机是对整个计算机（包括操作系统、处理器和程序）的抽象。
4. 分层
通过层次把复杂的、可能变化的东西隔离开来，某一层只能访问它的直接上层和下层，不能跨层访问。隔离变化。
5. 异步调用
6. 分而治之
基本思想是：将一个规模比较大的问题分解为多个规模较小的子问题，这些子问题相互独立且与原问题性质相同，求出子问题的解，最后组合起来就可得到原问题的解。

架构师的总结：
1. 好奇心
没有好奇心，没有兴趣，怎么会产生Passion（激情）呢？对技术的好奇心/兴趣是一切的基础。
2. 养成计算机的思维方式
程序员的基本功：养成计算机的思维方式，流畅地把人类语言的需求转换成计算机语言。
基本功的训练就是算法和数据结构；经验是多做习题，让思维在脑子里固化，以后的编程就可以信手拈来了。
3. 扎实基础，融会贯通
计算机组成原理、操作系统、编译原理、计算机网络、数据库、汇编语言。
4. 要透彻地理解一门技术的本质
只有学会使用是不行的，不但要知道How，还要知道Why。
停下来，思考，才是进步的本质。
5. 能写漂亮的代码
写出漂亮代码并不容易，需要思路清晰，有良好的编程基础，有优秀的抽象能力，以及对一门语言的熟练掌握。
6. 抽象的能力
把纷杂的事物抽象到数学层面，已经非常难了；哲学层面是尽头。
正交在数学上指的是线性无关。正交的威力在于互不影响、扩展方便。
抽象能力的训练没有捷径，就是积累经验、勤于思考、善于学习。
7. 技术领导力
要用技术的影响力来领导人，而不是权威和职位。
有了技术领导力，你在团队里发出的声音才会被倾听、被尊重。
贴上标签：大牛（大佬）。

看书，知识体系更加完整、理解更有深度。
写作：写笔记、写博客，从内容的消费者变成内容的生产者。
“转教别人”（Teach others）的办法属于主动学习，效率是最高的。

## 公众号文章

程序员的圣地：
- 量子力学
- 晶体管
- 逻辑电路
- 指令集/机器语言
- 汇编语言
- 高级语言
- 应用程序

技术管理者：既要管人，又要管事。特点是快速学习。通过漂亮的代码“征服”程序员，通过良好的沟通说服程序员。进可成为某个领域的专家，退可转型为管理者。

- 基础不牢，地动山摇。
- Joel Spolsky：抽象只能节省你的工作时间，不能节省你的学习时间。
